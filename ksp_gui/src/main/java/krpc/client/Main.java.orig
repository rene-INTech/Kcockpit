package krpc.client;

import com.fazecast.jSerialComm.*;
import krpc.client.services.*;
import krpc.client.services.SpaceCenter.*;

import java.io.InputStream;
import java.io.OutputStream;
import java.lang.Object;

import static java.nio.charset.StandardCharsets.UTF_16;
import static java.nio.charset.StandardCharsets.UTF_8;

public class Main{

    public static void main(String[] args) {
        try {

            SerialPort commPort= WaitFor.connectDevice();

            commPort.openPort();
            commPort.setBaudRate(115200);
            commPort.setComPortTimeouts(SerialPort.TIMEOUT_READ_BLOCKING | SerialPort.TIMEOUT_WRITE_BLOCKING, 1000, 1000);
            InputStream in = commPort.getInputStream();
            while (in==null){
                SOP("'in' vaut null");
                in= commPort.getInputStream();
            }
            OutputStream out = commPort.getOutputStream();

<<<<<<< HEAD
            Connection connection = WaitFor.connetcKrpc();
            KRPC krpc = KRPC.newInstance(connection);
            System.out.println("Connected to kRPC version " + krpc.getStatus().getVersion());
            SpaceCenter spaceCenter = SpaceCenter.newInstance(connection);
            Vessel vessel= WaitFor.activeVessel(spaceCenter);
            Control control = vessel.getControl();

=======
            while (true) {
                if (in.available() > 0) {
                    int incommingByte=in.read();
                    SOP("Recu " + incommingByte);
                    if (incommingByte==1) {
                        System.out.println("stage");
                    } else {
                        System.out.println("reÃ§u autre chose");
                    }
                    out.write(0);
                }

            }
>>>>>>> dev-serie

        }
        catch (UnknownOSException e){
            SOP("Mais t'es sur quel OS PUTAING!!");
        }
        catch (Exception e){
            e.printStackTrace();
        }
    }

    static void SOP(Object o){
        System.out.println(o);
    }
    static void sop(Object o){
        System.out.print(o);
    }
}
